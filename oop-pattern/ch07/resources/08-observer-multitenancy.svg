<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="864px" preserveAspectRatio="none" style="width:1320px;height:864px;" version="1.1" viewBox="0 0 1320 864" width="1320px" zoomAndPan="magnify"><defs><filter height="300%" id="f1pl6tvzw05gq6" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1pl6tvzw05gq6)" height="372.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="78" y="399.2422"/><rect fill="#FFFFFF" filter="url(#f1pl6tvzw05gq6)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="215.5" y="160.2344"/><rect fill="#FFFFFF" filter="url(#f1pl6tvzw05gq6)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="581" y="299.3047"/><line style="stroke:#A80036;stroke-width:1.0;" x1="83" x2="83" y1="88.2969" y2="98.2969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="83" x2="83" y1="98.2969" y2="139.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="83" x2="83" y1="139.1016" y2="237.3672"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="83" x2="83" y1="237.3672" y2="278.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="83" x2="83" y1="278.1719" y2="337.3047"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="83" x2="83" y1="337.3047" y2="378.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="83" x2="83" y1="378.1094" y2="780.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220" x2="220" y1="88.2969" y2="98.2969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="220" x2="220" y1="98.2969" y2="139.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220" x2="220" y1="139.1016" y2="237.3672"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="220" x2="220" y1="237.3672" y2="278.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220" x2="220" y1="278.1719" y2="337.3047"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="220" x2="220" y1="337.3047" y2="378.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220" x2="220" y1="378.1094" y2="780.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="397" x2="397" y1="88.2969" y2="98.2969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="397" x2="397" y1="98.2969" y2="139.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="397" x2="397" y1="139.1016" y2="237.3672"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="397" x2="397" y1="237.3672" y2="278.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="397" x2="397" y1="278.1719" y2="337.3047"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="397" x2="397" y1="337.3047" y2="378.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="397" x2="397" y1="378.1094" y2="780.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="586" x2="586" y1="88.2969" y2="98.2969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="586" x2="586" y1="98.2969" y2="139.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="586" x2="586" y1="139.1016" y2="237.3672"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="586" x2="586" y1="237.3672" y2="278.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="586" x2="586" y1="278.1719" y2="337.3047"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="586" x2="586" y1="337.3047" y2="378.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="586" x2="586" y1="378.1094" y2="780.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="808" x2="808" y1="88.2969" y2="98.2969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="808" x2="808" y1="98.2969" y2="139.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="808" x2="808" y1="139.1016" y2="237.3672"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="808" x2="808" y1="237.3672" y2="278.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="808" x2="808" y1="278.1719" y2="337.3047"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="808" x2="808" y1="337.3047" y2="378.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="808" x2="808" y1="378.1094" y2="780.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="909" x2="909" y1="88.2969" y2="98.2969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="909" x2="909" y1="98.2969" y2="139.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="909" x2="909" y1="139.1016" y2="237.3672"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="909" x2="909" y1="237.3672" y2="278.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="909" x2="909" y1="278.1719" y2="337.3047"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="909" x2="909" y1="337.3047" y2="378.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="909" x2="909" y1="378.1094" y2="780.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1130" x2="1130" y1="88.2969" y2="98.2969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1130" x2="1130" y1="98.2969" y2="139.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1130" x2="1130" y1="139.1016" y2="237.3672"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1130" x2="1130" y1="237.3672" y2="278.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1130" x2="1130" y1="278.1719" y2="337.3047"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1130" x2="1130" y1="337.3047" y2="378.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1130" x2="1130" y1="378.1094" y2="780.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="20" y="84.9951">CatalogRefresher</text><ellipse cx="83" cy="15" fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M83,23 L83,50 M70,31 L96,31 M83,50 L70,65 M83,50 L96,65 " fill="none" filter="url(#f1pl6tvzw05gq6)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="20" y="792.5654">CatalogRefresher</text><ellipse cx="83" cy="805.8672" fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M83,813.8672 L83,840.8672 M70,821.8672 L96,821.8672 M83,840.8672 L70,855.8672 M83,840.8672 L96,855.8672 " fill="none" filter="url(#f1pl6tvzw05gq6)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="125" x="156" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="163" y="72.9951">CatalogInitializer</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="125" x="156" y="779.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="163" y="799.5654">CatalogInitializer</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="200" x="295" y="36.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="96" x="347" y="56.6982">«Observable»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="186" x="302" y="72.9951">TenantDataSourceProvider</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="200" x="295" y="779.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="96" x="347" y="799.5654">«Observable»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="186" x="302" y="815.8623">TenantDataSourceProvider</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="150" x="509" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="516" y="72.9951">CatalogApiDelegate</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="150" x="509" y="779.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="516" y="799.5654">CatalogApiDelegate</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="116" x="748" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="755" y="72.9951">CatalogService</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="116" x="748" y="779.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="755" y="799.5654">CatalogService</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="58" x="878" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="885" y="72.9951">Cache</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="58" x="878" y="779.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="885" y="799.5654">Cache</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="356" x="950" y="36.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="81" x="1087.5" y="56.6982">«Observer»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="342" x="957" y="72.9951">DataSourceBasedMultiTenantConnectionProvider</text><rect fill="#FEFECE" filter="url(#f1pl6tvzw05gq6)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="356" x="950" y="779.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="81" x="1087.5" y="799.5654">«Observer»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="342" x="957" y="815.8623">DataSourceBasedMultiTenantConnectionProvider</text><rect fill="#FFFFFF" filter="url(#f1pl6tvzw05gq6)" height="372.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="78" y="399.2422"/><rect fill="#FFFFFF" filter="url(#f1pl6tvzw05gq6)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="215.5" y="160.2344"/><rect fill="#FFFFFF" filter="url(#f1pl6tvzw05gq6)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="581" y="299.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="545" y="122.5073">at application boot up</text><polygon fill="#A80036" points="385,156.2344,395,160.2344,385,164.2344,389,160.2344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="225.5" x2="391" y1="160.2344" y2="160.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="232.5" y="155.1685">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="245.5" y="155.1685">findAll()</text><path d="M5,203.2344 L5,228.2344 L212,228.2344 L212,213.2344 L202,203.2344 L5,203.2344 " fill="#FBFB77" filter="url(#f1pl6tvzw05gq6)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M202,203.2344 L202,213.2344 L212,213.2344 L202,203.2344 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="11" y="220.3013">Load catalog on to the cache</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="574.5" y="261.5776">at any time</text><polygon fill="#A80036" points="796,295.3047,806,299.3047,796,303.3047,800,299.3047" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="591" x2="802" y1="299.3047" y2="299.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="598" y="294.2388">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="611" y="294.2388">createTenant(TenantInfoDto)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="119" x="547" y="361.5151">on every 60 seconds</text><polygon fill="#A80036" points="208.5,395.2422,218.5,399.2422,208.5,403.2422,212.5,399.2422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="88" x2="214.5" y1="399.2422" y2="399.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="95" y="394.1763">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="108" y="394.1763">refresh()</text><polygon fill="#A80036" points="385,424.375,395,428.375,385,432.375,389,428.375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220.5" x2="391" y1="428.375" y2="428.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="227.5" y="423.3091">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="240.5" y="423.3091">refresh()</text><polygon fill="#A80036" points="897,453.5078,907,457.5078,897,461.5078,901,457.5078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="397" x2="903" y1="457.5078" y2="457.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="404" y="452.4419">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="417" y="452.4419">evictIfPresent(CACHE_KEY)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="397" x2="439" y1="486.6406" y2="486.6406"/><line style="stroke:#A80036;stroke-width:1.0;" x1="439" x2="439" y1="486.6406" y2="499.6406"/><line style="stroke:#A80036;stroke-width:1.0;" x1="398" x2="439" y1="499.6406" y2="499.6406"/><polygon fill="#A80036" points="408,495.6406,398,499.6406,408,503.6406,404,499.6406" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="404" y="481.5747">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="417" y="481.5747">findAll()</text><path d="M296,512.6406 L296,537.6406 L388,537.6406 L388,522.6406 L378,512.6406 L296,512.6406 " fill="#FBFB77" filter="url(#f1pl6tvzw05gq6)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M378,512.6406 L378,522.6406 L388,522.6406 L378,512.6406 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="302" y="529.7075">Refill cache</text><line style="stroke:#A80036;stroke-width:1.0;" x1="397" x2="439" y1="567.9063" y2="567.9063"/><line style="stroke:#A80036;stroke-width:1.0;" x1="439" x2="439" y1="567.9063" y2="580.9063"/><line style="stroke:#A80036;stroke-width:1.0;" x1="398" x2="439" y1="580.9063" y2="580.9063"/><polygon fill="#A80036" points="408,576.9063,398,580.9063,408,584.9063,404,580.9063" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="404" y="562.8403">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="417" y="562.8403">setChanged(true)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="397" x2="439" y1="610.0391" y2="610.0391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="439" x2="439" y1="610.0391" y2="623.0391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="398" x2="439" y1="623.0391" y2="623.0391"/><polygon fill="#A80036" points="408,619.0391,398,623.0391,408,627.0391,404,623.0391" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="404" y="604.9731">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="417" y="604.9731">notifyObservers()</text><polygon fill="#A80036" points="1118,648.1719,1128,652.1719,1118,656.1719,1122,652.1719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="397" x2="1124" y1="652.1719" y2="652.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="404" y="647.106">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="417" y="647.106">update(Observable)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1130" x2="1172" y1="681.3047" y2="681.3047"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1172" x2="1172" y1="681.3047" y2="694.3047"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1131" x2="1172" y1="694.3047" y2="694.3047"/><polygon fill="#A80036" points="1141,690.3047,1131,694.3047,1141,698.3047,1137,694.3047" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1137" y="676.2388">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="1150" y="676.2388">load()</text><polygon fill="#A80036" points="408,719.4375,398,723.4375,408,727.4375,404,723.4375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="402" x2="1129" y1="723.4375" y2="723.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="414" y="718.3716">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="427" y="718.3716">findAll()</text><path d="M694,736.4375 L694,761.4375 L1121,761.4375 L1121,746.4375 L1111,736.4375 L694,736.4375 " fill="#FBFB77" filter="url(#f1pl6tvzw05gq6)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1111,736.4375 L1111,746.4375 L1121,746.4375 L1111,736.4375 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="406" x="700" y="753.5044">update tenantDataSourceMap: HashMap&lt;String, DataSource&gt;</text><!--MD5=[c1cc721f6268b5f006b63c938f48ca21]
@startuml
actor CatalogRefresher
participant CatalogInitializer
participant TenantDataSourceProvider <<Observable>>

participant CatalogApiDelegate
participant CatalogService

participant Cache
participant DataSourceBasedMultiTenantConnectionProvider <<Observer>>

... at application boot up ...

autonumber
CatalogInitializer -> TenantDataSourceProvider: findAll()
activate CatalogInitializer
deactivate CatalogInitializer
note left of CatalogInitializer
  Load catalog on to the cache
end note 


... at any time ...

autonumber
CatalogApiDelegate -> CatalogService: createTenant(TenantInfoDto)
activate CatalogApiDelegate
deactivate CatalogApiDelegate

... on every 60 seconds ...

autonumber
CatalogRefresher -> CatalogInitializer: refresh()
activate CatalogRefresher
  CatalogInitializer -> TenantDataSourceProvider: refresh()
    TenantDataSourceProvider -> Cache: evictIfPresent(CACHE_KEY)
    TenantDataSourceProvider -> TenantDataSourceProvider: findAll()
    note left of TenantDataSourceProvider
      Refill cache
    end note
    TenantDataSourceProvider -> TenantDataSourceProvider: setChanged(true)
    TenantDataSourceProvider -> TenantDataSourceProvider: notifyObservers()
    TenantDataSourceProvider -> DataSourceBasedMultiTenantConnectionProvider: update(Observable)
      DataSourceBasedMultiTenantConnectionProvider -> DataSourceBasedMultiTenantConnectionProvider: load()
      DataSourceBasedMultiTenantConnectionProvider -> TenantDataSourceProvider: findAll()
    note left of DataSourceBasedMultiTenantConnectionProvider
      update tenantDataSourceMap: HashMap<String, DataSource>
    end note
@enduml

PlantUML version 1.2020.22(Sun Dec 06 09:36:27 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>